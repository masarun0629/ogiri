<div class="index_main">
  <%= link_to '< Ââç„ÅÆ„Éö„Éº„Ç∏„Å∏Êàª„Çã',:back, class: "redirect_back" %>
  <%= link_to '<< „Éà„ÉÉ„Éó„Éö„Éº„Ç∏„Å∏Êàª„Çã',root_path, class: "redirect" %>
  <div class="ranking"><%= "„É¶„Éº„Ç∂„Éº„É©„É≥„Ç≠„É≥„Ç∞TOP10(#{@users.count}‰∫∫‰∏≠)" %></div>
    <div class="rank_index">
      <% if params[:like_average] %>
        <%= link_to 'Á∑èÂêà„É©„É≥„Ç≠„É≥„Ç∞',users_path,class: "new_questions" %>:
        <%= link_to 'Âπ≥Âùá„É©„É≥„Ç≠„É≥„Ç∞(1ÂõûÁ≠î„ÅÇ„Åü„Çä)', users_path(like_average:"true") %>       
      <% else %>
        <%= link_to 'Á∑èÂêà„É©„É≥„Ç≠„É≥„Ç∞',users_path %>:
        <%= link_to 'Âπ≥Âùá„É©„É≥„Ç≠„É≥„Ç∞(1ÂõûÁ≠î„ÅÇ„Åü„Çä)',users_path(like_average:"true"),class: "new_questions" %>
      <% end %>
    </div>
    <% if params[:like_average] %>
      <div class="rankings">
        <table border="1">
          <tr>
            <th>üëë</th><th>„Éã„ÉÉ„ÇØ„Éç„Éº„É†</th><th>Âπ≥Âùáüß°Áç≤ÂæóÊï∞</th>
          </tr>
            <% num = 0 %>
            <% @user_answer_like_ranks.first(10).each do |user| %>
              <% num += 1%>
                <tr>
                  <td><%= num %>‰Ωç</td>
                  <td><%= link_to user.nickname,user_path(user.id),class: "rank_user" %></td>
                  <% user_answers = user.answers %>
                  <% likes_count = 0 %>
                  <% user_answers.each do |answer| %>
                    <% likes_count += answer.likes.count %>
                  <% end %>
                  <td><%= sprintf("%.2f",likes_count/user_answers.count.to_f) %></td>
                </tr>
          <% end %>
        </table>
      </div>
    <% else %>
      <div class="rankings">
        <table border="1">
          <tr>
            <th>üëë</th><th>„Éã„ÉÉ„ÇØ„Éç„Éº„É†</th><th>ÂêàË®àüß°Áç≤ÂæóÊï∞</th>
          </tr>
            <% num = 0 %>
            <% @user_answer_like_ranks.first(10).each do |user| %>
              <% num += 1%>
                <tr>
                  <td><%= num %>‰Ωç</td>
                  <td><%= link_to user.nickname,user_path(user.id),class: "rank_user" %></td>
                  <% user_answers = user.answers %>
                  <% likes_count = 0 %>
                  <% user_answers.each do |answer| %>
                    <% likes_count += answer.likes.count %>
                  <% end %>
                  <td><%= likes_count %></td>
                </tr>
            <% end %>
        </table>
      </div>
    <% end %>
</div>